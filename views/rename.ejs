<!DOCTYPE html>
<html lang="zh-CN" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai é‡å‘½å - å·¥å…·é›†</title>

    <!-- Bootstrap CSS -->
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <link href="/css/custom.css" rel="stylesheet">
    <style>
        /* æ‹–æ‹½ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .upload-area:hover, .upload-area.drag-over {
            border-color: #0d6efd;
            background-color: rgba(13, 110, 253, 0.05);
        }
        .file-item {
            transition: all 0.2s ease;
        }
        .file-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        [data-bs-theme="dark"] .file-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* é¢„è§ˆåŒºåŸŸæ ·å¼ */
        .preview-item {
            transition: all 0.2s ease;
        }
        .preview-item:hover {
            background-color: rgba(0, 0, 0, 0.02) !important;
        }
        .preview-item:last-child {
            border-bottom: none !important;
        }
        [data-bs-theme="dark"] .preview-item:hover {
            background-color: rgba(255, 255, 255, 0.02) !important;
        }

        /* å·¦å³åˆ†æ å¸ƒå±€ä¼˜åŒ– */
        .row.h-100 {
            min-height: 600px;
        }
        .col-lg-4.border-end {
            border-color: #dee2e6 !important;
        }
        [data-bs-theme="dark"] .col-lg-4.border-end {
            border-color: #495057 !important;
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        #previewContent::-webkit-scrollbar,
        #fileList::-webkit-scrollbar,
        #resultContent::-webkit-scrollbar {
            width: 6px;
        }
        #previewContent::-webkit-scrollbar-track,
        #fileList::-webkit-scrollbar-track,
        #resultContent::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        #previewContent::-webkit-scrollbar-thumb,
        #fileList::-webkit-scrollbar-thumb,
        #resultContent::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        #previewContent::-webkit-scrollbar-thumb:hover,
        #fileList::-webkit-scrollbar-thumb:hover,
        #resultContent::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        [data-bs-theme="dark"] #previewContent::-webkit-scrollbar-track,
        [data-bs-theme="dark"] #fileList::-webkit-scrollbar-track,
        [data-bs-theme="dark"] #resultContent::-webkit-scrollbar-track {
            background: #343a40;
        }
        [data-bs-theme="dark"] #previewContent::-webkit-scrollbar-thumb,
        [data-bs-theme="dark"] #fileList::-webkit-scrollbar-thumb,
        [data-bs-theme="dark"] #resultContent::-webkit-scrollbar-thumb {
            background: #6c757d;
        }

        /* æ–‡ä»¶å¤„ç†çŠ¶æ€æ ·å¼ */
        .file-process-item {
            transition: all 0.3s ease;
        }

        .file-process-item.processing {
            background-color: rgba(255, 193, 7, 0.1);
            border-left: 3px solid #ffc107;
        }


        .file-process-item.error {
            background-color: rgba(220, 53, 69, 0.1);
            border-left: 3px solid #dc3545;
        }

        /* æ·±è‰²æ¨¡å¼é€‚é… */
        [data-bs-theme="dark"] .file-process-item.processing {
            background-color: rgba(255, 193, 7, 0.15);
        }

       

        [data-bs-theme="dark"] .file-process-item.error {
            background-color: rgba(220, 53, 69, 0.15);
        }

        /* å»ºè®®åç§°æ ·å¼ - æ·±è‰²æ¨¡å¼é€‚é… */
        .suggested-name {
            animation: fadeInUp 0.5s ease;
            background-color: rgba(13, 110, 253, 0.1) !important;
            border: 1px solid rgba(13, 110, 253, 0.2);
        }

        [data-bs-theme="dark"] .suggested-name {
            background-color: rgba(13, 110, 253, 0.15) !important;
            border: 1px solid rgba(13, 110, 253, 0.3);
            color: #e9ecef;
        }

        [data-bs-theme="dark"] .suggested-name .text-primary {
            color: #6ea8fe !important;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .spinner-border-sm {
            animation: spinner-border 0.75s linear infinite;
        }

        @keyframes spinner-border {
            to {
                transform: rotate(360deg);
            }
        }



        .file-process-item:last-child {
            margin-bottom: 0;
        }

        /* ç¡®ä¿æ–‡ä»¶åˆ—è¡¨å†…å®¹ä¸è¢«å³ä¾§é…ç½®æ é®æŒ¡ */
        .file-process-item {
            padding-right: 15px;
        }

        /* å»ºè®®åç§°åŒºåŸŸä¼˜åŒ– */
        .suggested-name {
            max-width: 100%;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* ç»Ÿè®¡åŒºåŸŸæ ·å¼ä¼˜åŒ– */
        #statsFooter {
            margin-top: auto;
        }

        /* å¤šAIé…ç½®æ ·å¼ */
        .ai-config-section {
            transition: all 0.3s ease;
        }

        .model-priority-list {
            min-height: 200px;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 0.5rem;
            background-color: #f8f9fa;
        }

        /* ç´§å‡‘åˆ—è¡¨æ ·å¼ */
        .model-priority-compact-list {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            background-color: #f8f9fa;
            max-height: 300px;
            overflow-y: auto;
        }

        /* æ·±è‰²æ¨¡å¼é€‚é… - ç´§å‡‘åˆ—è¡¨ */
        [data-bs-theme="dark"] .model-priority-compact-list {
            border-color: #495057;
            background-color: #343a40;
        }

        /* ç´§å‡‘åˆ—è¡¨æ»šåŠ¨æ¡æ ·å¼ */
        .model-priority-compact-list::-webkit-scrollbar {
            width: 6px;
        }

        .model-priority-compact-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .model-priority-compact-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .model-priority-compact-list::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* æ·±è‰²æ¨¡å¼æ»šåŠ¨æ¡ */
        [data-bs-theme="dark"] .model-priority-compact-list::-webkit-scrollbar-track {
            background: #495057;
        }

        [data-bs-theme="dark"] .model-priority-compact-list::-webkit-scrollbar-thumb {
            background: #6c757d;
        }

        [data-bs-theme="dark"] .model-priority-compact-list::-webkit-scrollbar-thumb:hover {
            background: #adb5bd;
        }

        .model-priority-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: move;
            transition: all 0.2s ease;
        }

        /* ç´§å‡‘åˆ—è¡¨é¡¹æ ·å¼ */
        .model-priority-compact-item {
            background: white;
            border-bottom: 1px solid #dee2e6;
            padding: 0.5rem 0.75rem;
            cursor: move;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„ä¼ªå…ƒç´ å›¾æ ‡ */
        .model-priority-compact-item::before,
        .model-priority-compact-item::after,
        .model-priority-item::before,
        .model-priority-item::after {
            display: none !important;
            content: none !important;
        }

        /* æ·±è‰²æ¨¡å¼é€‚é… - ç´§å‡‘åˆ—è¡¨é¡¹ */
        [data-bs-theme="dark"] .model-priority-compact-item {
            background: #495057;
            border-bottom-color: #6c757d;
            color: #e9ecef;
        }

        .model-priority-compact-item:last-child {
            border-bottom: none;
        }

        .model-priority-compact-item:hover {
            background-color: #f8f9fa;
        }

        /* æ·±è‰²æ¨¡å¼æ‚¬åœæ•ˆæœ */
        [data-bs-theme="dark"] .model-priority-compact-item:hover {
            background-color: #6c757d;
        }

        .model-priority-compact-item.dragging {
            opacity: 0.5;
            background-color: #e9ecef;
        }

        /* æ·±è‰²æ¨¡å¼æ‹–æ‹½æ•ˆæœ */
        [data-bs-theme="dark"] .model-priority-compact-item.dragging {
            background-color: #6c757d;
        }

        .model-priority-item:hover {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }

        /* æ·±è‰²æ¨¡å¼æ‚¬åœé˜´å½± */
        [data-bs-theme="dark"] .model-priority-item:hover {
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .model-priority-item:last-child {
            margin-bottom: 0;
        }

        .model-priority-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .provider-name {
            font-weight: 600;
            color: #495057;
        }

        /* æ·±è‰²æ¨¡å¼æ–‡æœ¬é¢œè‰² */
        [data-bs-theme="dark"] .provider-name {
            color: #e9ecef;
        }

        .model-name {
            color: #6c757d;
            font-size: 0.875rem;
        }

        [data-bs-theme="dark"] .model-name {
            color: #adb5bd;
        }

        /* ç¡®ä¿æ ‡è¯†åœ¨æ·±è‰²æ¨¡å¼ä¸‹å¯è§ */
        [data-bs-theme="dark"] .badge {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* æ‹–æ‹½æ‰‹æŸ„åœ¨æ·±è‰²æ¨¡å¼ä¸‹çš„é¢œè‰² */
        [data-bs-theme="dark"] .bi-grip-vertical {
            color: #adb5bd !important;
        }

        /* å¤é€‰æ¡†åœ¨æ·±è‰²æ¨¡å¼ä¸‹çš„æ ·å¼ */
        [data-bs-theme="dark"] .form-check-input {
            background-color: #495057;
            border-color: #6c757d;
        }

        [data-bs-theme="dark"] .form-check-input:checked {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .btn-check:checked + .btn-outline-primary {
            background-color: #007bff;
            border-color: #007bff;
            color: white;
        }

        .btn-check:checked + .btn-outline-success {
            background-color: #28a745;
            border-color: #28a745;
            color: white;
        }

        .toggle-key {
            cursor: pointer;
        }

        .api-key-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 0.5rem;
        }

        .api-key-status.valid {
            background-color: #28a745;
        }

        .api-key-status.invalid {
            background-color: #dc3545;
        }

        .priority-badge {
            background-color: #007bff;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            margin-left: auto;
            border-top: 1px solid rgba(0, 0, 0, 0.125);
        }

        [data-bs-theme="dark"] #statsFooter {
            border-top-color: rgba(255, 255, 255, 0.125);
            background-color: rgba(255, 255, 255, 0.05) !important;
        }

        /* æœªé…ç½®æ¨¡å‹æ ·å¼ */
        .unconfigured-model {
            opacity: 0.7;
            border-left: 3px solid #6c757d !important;
        }

        .unconfigured-model .model-name {
            color: #6c757d !important;
        }

        .unconfigured-model .provider-name {
            color: #6c757d !important;
        }

        /* æ·±è‰²ä¸»é¢˜ä¸‹çš„æœªé…ç½®æ¨¡å‹ */
        [data-bs-theme="dark"] .unconfigured-model {
            border-left-color: #495057 !important;
        }

        [data-bs-theme="dark"] .unconfigured-model .model-name {
            color: #adb5bd !important;
        }

        [data-bs-theme="dark"] .unconfigured-model .provider-name {
            color: #adb5bd !important;
        }

        /* æ¨¡å‹ä¼˜å…ˆçº§åˆ†éš”çº¿ */
        .model-priority-separator {
            border-top: 1px dashed #dee2e6;
            margin: 10px 0;
            position: relative;
        }

        .model-priority-separator::before {
            content: "æœªé…ç½®æ¨¡å‹";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bs-body-bg);
            padding: 0 10px;
            font-size: 12px;
            color: #6c757d;
        }

        [data-bs-theme="dark"] .model-priority-separator {
            border-top-color: #495057;
        }
    </style>
</head>
<body>
<div class="app-container">
    <!-- å·¦ä¾§ä¾§è¾¹æ  -->
    <div class="sidebar bg-light border-end" id="sidebar">
        <%- include('partials/sidebar') %>
    </div>

    <!-- å³ä¾§ä¸»å†…å®¹åŒº -->
    <div class="main-content" id="main-content">
        <main class="p-4">
            <div class="container-fluid">
                <!-- é¡µé¢æ ‡é¢˜ -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h2>
                            <i class="bi bi-magic text-primary me-2"></i>
                            æ™ºèƒ½æ–‡ä»¶é‡å‘½å
                        </h2>
                        <p class="text-muted">åŸºäºAIçš„æ™ºèƒ½æ–‡ä»¶é‡å‘½åå·¥å…· - æ”¯æŒæ–‡æ¡£å†…å®¹åˆ†æå’Œè¯­ä¹‰ç†è§£</p>
                    </div>
                </div>

                <!-- ä¸»è¦å†…å®¹åŒºåŸŸ - å·¦å³åˆ†æ å¸ƒå±€ -->
                <div class="row">
                    <!-- å·¦ä¾§ï¼šé…ç½®æ  -->
                    <div class="col-4 mb-4">
                        <!-- ç¬¬ä¸€æ­¥ï¼šæ–‡ä»¶å¤¹é€‰æ‹©åŒºåŸŸ -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-folder2-open me-2"></i>
                                    ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ–‡ä»¶å¤¹
                                </h6>
                            </div>
                            <div class="card-body">
                                <!-- æ‹–æ‹½æ–‡ä»¶å¤¹åŒºåŸŸ -->
                                <div class="upload-area text-center p-3 mb-3" id="dropZone">
                                    <i class="bi bi-folder-plus display-6 text-primary mb-2" id="dropIcon"></i>
                                    <h6 id="dropTitle">æ‹–æ‹½æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åˆ°æ­¤åŒºåŸŸ</h6>
                                    <p class="text-muted small mb-0" id="dropDescription">
                                        æ”¯æŒå•ä¸ªæ–‡ä»¶ã€å¤šä¸ªæ–‡ä»¶æˆ–æ•´ä¸ªæ–‡ä»¶å¤¹<br>
                                        è‡ªåŠ¨æ‰«ææ–‡ä»¶å¤¹å†…å®¹ï¼Œè·å–å®Œæ•´è·¯å¾„ç”¨äºé‡å‘½å
                                    </p>

                                    <!-- æ‹–æ‹½è¿›åº¦æŒ‡ç¤ºå™¨ -->
                                    <div class="mt-2" id="dropProgress" style="display: none;">
                                        <div class="progress mb-2" style="height: 4px;">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                 role="progressbar" style="width: 0%" id="dropProgressBar"></div>
                                        </div>
                                        <small class="text-muted" id="dropProgressText">æ­£åœ¨å¤„ç†...</small>
                                    </div>
                                </div>

                                <!-- æ‰«æé€‰é¡¹ -->
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="includeSubfolders" checked>
                                        <label class="form-check-label" for="includeSubfolders">
                                            <i class="bi bi-folder-symlink me-1"></i>
                                            åŒ…å«å­æ–‡ä»¶å¤¹
                                        </label>
                                        <small class="form-text text-muted d-block">
                                            å‹¾é€‰åå°†é€’å½’æ‰«ææ‰€æœ‰å­æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶
                                        </small>
                                    </div>
                                </div>

                                <!-- æ–‡ä»¶å¤¹é€‰æ‹©æŒ‰é’® -->
                                <div class="mb-3">
                                    <button class="btn btn-primary w-100" id="selectFolder">
                                        <i class="bi bi-folder2-open me-2"></i>é€‰æ‹©æ–‡ä»¶å¤¹
                                    </button>
                                </div>

                                <!-- å½“å‰é€‰æ‹©æ˜¾ç¤º -->
                                <div class="small text-muted" id="folderInfo">
                                    <i class="bi bi-info-circle me-1"></i>
                                    è¯·é€‰æ‹©åŒ…å«éœ€è¦é‡å‘½åæ–‡ä»¶çš„æ–‡ä»¶å¤¹
                                </div>
                            </div>
                        </div>

                        <!-- ç¬¬äºŒæ­¥ï¼šAIé…ç½®åŒºåŸŸ -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-robot me-2"></i>
                                    ç¬¬äºŒæ­¥ï¼šAIé…ç½®
                                </h6>
                            </div>
                            <div class="card-body">
                                <!-- å¤šAIæœåŠ¡å•†é…ç½® -->
                                <div class="mb-4">
                                    <!-- é…ç½®æ¨¡å¼é€‰æ‹© -->
                                    <div class="row mb-3">
                                        <div class="col-12">
                                            <label class="form-label">AIé…ç½®æ¨¡å¼</label>
                                            <div class="btn-group w-100" role="group">
                                                <input type="radio" class="btn-check" name="aiConfigMode" id="singleAI" value="single" checked>
                                                <label class="btn btn-outline-primary" for="singleAI">
                                                    <i class="bi bi-cpu me-2"></i>å•ä¸€æœåŠ¡å•†
                                                </label>
                                                <input type="radio" class="btn-check" name="aiConfigMode" id="multiAI" value="multi">
                                                <label class="btn btn-outline-success" for="multiAI">
                                                    <i class="bi bi-diagram-3 me-2"></i>å¤šæœåŠ¡å•†æ™ºèƒ½é‡è¯•
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- å•ä¸€æœåŠ¡å•†é…ç½® -->
                                    <div id="singleAIConfig" class="ai-config-section">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="alert alert-info">
                                                    <i class="bi bi-info-circle me-2"></i>
                                                    ä½¿ç”¨å…¨å±€è®¾ç½®ä¸­é…ç½®çš„APIå¯†é’¥ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œè¯·å‰å¾€
                                                    <a href="/settings" class="alert-link">å…¨å±€è®¾ç½®</a> é¡µé¢ã€‚
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="aiModel" class="form-label">
                                                    AIæ¨¡å‹ç­–ç•¥
                                                    <button type="button" class="btn btn-sm btn-outline-info ms-2" id="modelCompareBtn">
                                                        <i class="bi bi-info-circle"></i> æ¨¡å‹å¯¹æ¯”
                                                    </button>
                                                </label>
                                                <select class="form-select" id="aiModel">
                                                    <optgroup label="ğŸ’¬ å¯¹è¯æ¨¡å‹ (æ¨è)">
                                                        <option value="chat:Qwen/Qwen3-Next-80B-A3B-Instruct" selected>â­ Qwen3-Next-80B (æœ€å¿«)</option>
                                                        <option value="chat:Qwen/Qwen2.5-72B-Instruct-128K">â­ Qwen2.5-72B (æ¨è)</option>
                                                        <option value="chat:Pro/deepseek-ai/DeepSeek-V3">DeepSeek-V3 (é«˜æ€§èƒ½)</option>
                                                        <option value="chat:Pro/deepseek-ai/DeepSeek-R1">DeepSeek-R1 (æ¨ç†)</option>
                                                        <option value="chat:Qwen/Qwen3-30B-A3B">Qwen3-30B (å¿«é€Ÿ)</option>
                                                    </optgroup>
                                                    <optgroup label="ğŸ‘ï¸ è§†è§‰æ¨¡å‹">
                                                        <option value="vision:Qwen/Qwen2.5-VL-32B-Instruct">Qwen2.5-VL-32B (å›¾ç‰‡åˆ†æ)</option>
                                                    </optgroup>
                                                    <optgroup label="ğŸ”„ å¤šæœåŠ¡å•†æ¨¡å‹">
                                                        <option value="chat:doubao-seed-1-6-thinking-250615">è±†åŒ…1.6 Thinking</option>
                                                        <option value="vision:doubao-seed-1-6-flash-250615">â­ è±†åŒ…1.6 Flash (è§†è§‰å¿«é€Ÿ)</option>
                                                        <option value="chat:deepseek-chat">DeepSeek Chat (å®˜æ–¹)</option>
                                                        <option value="chat:deepseek-reasoner">DeepSeek R1 (å®˜æ–¹æ¨ç†)</option>
                                                    </optgroup>
                                                </select>
                                                <div class="form-text">
                                                    <i class="bi bi-info-circle me-1"></i>
                                                    â­ æ ‡è®°ä¸ºæ¨èæ¨¡å‹ï¼ŒåŸºäºæµ‹è¯•æ€§èƒ½ä¼˜åŒ–é€‰æ‹©
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- å¤šæœåŠ¡å•†é…ç½® -->
                                    <div id="multiAIConfig" class="ai-config-section" style="display: none;">
                                        <!-- APIå¯†é’¥é…ç½®æç¤º -->
                                        <div class="alert alert-info mb-3">
                                            <i class="bi bi-info-circle me-2"></i>
                                            ä½¿ç”¨å…¨å±€è®¾ç½®ä¸­é…ç½®çš„APIå¯†é’¥ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œè¯·å‰å¾€
                                            <a href="/settings" class="alert-link">å…¨å±€è®¾ç½®</a> é¡µé¢ã€‚
                                        </div>

                                        <!-- æ¨¡å‹ä¼˜å…ˆçº§é…ç½® -->
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="mb-0">
                                                    <i class="bi bi-list-ol me-2"></i>æ¨¡å‹ä¼˜å…ˆçº§é…ç½®
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <!-- å¯¹è¯æ¨¡å‹ä¼˜å…ˆçº§ -->
                                                <div class="mb-4">
                                                    <label class="form-label fw-bold">ğŸ’¬ å¯¹è¯æ¨¡å‹ä¼˜å…ˆçº§</label>
                                                    <div id="chatModelPriorities" class="model-priority-compact-list">
                                                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                                                    </div>
                                                </div>

                                                <!-- è§†è§‰æ¨¡å‹ä¼˜å…ˆçº§ -->
                                                <div class="mb-3">
                                                    <label class="form-label fw-bold">ğŸ‘ï¸ è§†è§‰æ¨¡å‹ä¼˜å…ˆçº§</label>
                                                    <div id="visionModelPriorities" class="model-priority-compact-list">
                                                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                                                    </div>
                                                </div>

                                                <div class="form-text">
                                                    <i class="bi bi-info-circle me-1"></i>
                                                    æ‹–æ‹½è°ƒæ•´ä¼˜å…ˆçº§ï¼Œé‡åˆ°APIé™åˆ¶æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ¨¡å‹
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ç¬¬ä¸‰æ­¥ï¼šé‡å‘½åé…ç½®åŒºåŸŸ -->
                        <div class="card mb-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-gear me-2"></i>
                                    ç¬¬ä¸‰æ­¥ï¼šé‡å‘½åé…ç½®
                                </h6>
                            </div>
                            <div class="card-body">
                                <!-- å‘½åæ¨¡æ¿é€‰æ‹© -->
                                <div class="mb-3">
                                    <label for="namingTemplate" class="form-label">å‘½åæ¨¡æ¿</label>
                                    <select class="form-select" id="namingTemplate">
                                        <option value="semantic">è¯­ä¹‰æ¨¡æ¿ (åŸºäºå†…å®¹ç”Ÿæˆ)</option>
                                        <option value="date_content">æ—¥æœŸ+å†…å®¹æ¨¡æ¿</option>
                                        <option value="category_name">åˆ†ç±»+åç§°æ¨¡æ¿</option>
                                        <option value="custom">è‡ªå®šä¹‰æ¨¡æ¿</option>
                                    </select>
                                </div>

                                <!-- è‡ªå®šä¹‰æç¤ºè¯ -->
                                <div class="mb-3">
                                    <label for="customPrompt" class="form-label">è‡ªå®šä¹‰æç¤ºè¯ (å¯é€‰)</label>
                                    <textarea class="form-control" id="customPrompt" rows="3"
                                              placeholder="ä¾‹å¦‚ï¼šæ ¹æ®æ–‡æ¡£å†…å®¹ç”Ÿæˆä¸“ä¸šçš„æ–‡ä»¶åï¼Œçªå‡ºä¸»é¢˜å’Œç±»å‹"></textarea>
                                    <div class="form-text">AIå°†æ ¹æ®æ­¤æç¤ºè¯å’Œæ–‡ä»¶å†…å®¹ç”Ÿæˆæ›´ç¬¦åˆéœ€æ±‚çš„æ–‡ä»¶å</div>
                                </div>

                                <!-- é«˜çº§é€‰é¡¹ -->
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="preserveExtension" checked>
                                        <label class="form-check-label" for="preserveExtension">
                                            ä¿ç•™æ–‡ä»¶æ‰©å±•å
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="removeSpecialChars" checked>
                                        <label class="form-check-label" for="removeSpecialChars">
                                            ç§»é™¤ç‰¹æ®Šå­—ç¬¦
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="useOCR" checked>
                                        <label class="form-check-label" for="useOCR">
                                            <i class="bi bi-eye me-1"></i>å›¾ç‰‡OCRæ–‡å­—è¯†åˆ«
                                        </label>
                                        <div class="form-text ms-4">
                                            <small class="text-muted">
                                                <i class="bi bi-info-circle me-1"></i>
                                                å‹¾é€‰åå›¾ç‰‡æ–‡ä»¶å°†ä½¿ç”¨OCR + è§†è§‰æ¨¡å‹ç»„åˆæ–¹æ¡ˆï¼Œæé«˜è¯†åˆ«å‡†ç¡®åº¦
                                            </small>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="enableConcurrency" checked>
                                        <label class="form-check-label" for="enableConcurrency">
                                            <i class="bi bi-lightning me-1"></i>å¯ç”¨å¹¶å‘å¤„ç†
                                        </label>
                                        <div class="form-text ms-4">
                                            <small class="text-muted">
                                                <i class="bi bi-speedometer2 me-1"></i>
                                                åŒæ—¶å¤„ç†å¤šä¸ªæ–‡ä»¶ï¼Œæ˜¾è‘—æå‡å¤„ç†é€Ÿåº¦
                                            </small>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="skipProcessed" checked>
                                        <label class="form-check-label" for="skipProcessed">
                                            <i class="bi bi-skip-forward me-1"></i>è·³è¿‡å·²æ™ºèƒ½å‘½åè¿‡çš„æ–‡ä»¶
                                        </label>
                                        <div class="form-text ms-4">
                                            <small class="text-muted">
                                                <i class="bi bi-database me-1"></i>
                                                ç³»ç»Ÿä¼šè®°å½•å·²å¤„ç†çš„æ–‡ä»¶ï¼Œé¿å…é‡å¤å¤„ç†æé«˜æ•ˆç‡
                                            </small>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="smartKeepOriginal">
                                        <label class="form-check-label" for="smartKeepOriginal">
                                            <i class="bi bi-shield-check me-1"></i>æ™ºèƒ½ä¿ç•™åŸå
                                        </label>
                                        <div class="form-text ms-4">
                                            <small class="text-muted">
                                                è‡ªåŠ¨è¯†åˆ«å·²æœ‰æ˜ç¡®å«ä¹‰çš„æ–‡ä»¶åå¹¶ä¿æŒä¸å˜<br>
                                                å¦‚ï¼š2025å¹´8æœˆ26æ—¥ çº¸å·¾å¾…å‘è´§.xlsx â†’ ä¿æŒåŸå
                                            </small>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="openFolderAfter">
                                        <label class="form-check-label" for="openFolderAfter">
                                            é‡å‘½ååæ‰“å¼€æ–‡ä»¶å¤¹
                                        </label>
                                    </div>
                                </div>

                                <!-- æ€§èƒ½é…ç½® -->
                                <div class="mb-3" id="performanceConfig">
                                    <label for="concurrencyLevel" class="form-label">
                                        <i class="bi bi-gear me-1"></i>å¹¶å‘çº§åˆ«
                                    </label>
                                    <select class="form-select" id="concurrencyLevel">
                                        <option value="2">ä¿å®ˆ (2ä¸ªå¹¶å‘)</option>
                                        <option value="3" selected>å¹³è¡¡ (3ä¸ªå¹¶å‘)</option>
                                        <option value="5">æ¿€è¿› (5ä¸ªå¹¶å‘)</option>
                                        <option value="8">æé€Ÿ (8ä¸ªå¹¶å‘)</option>
                                    </select>
                                    <div class="form-text">
                                        <i class="bi bi-info-circle me-1"></i>
                                        å¹¶å‘æ•°è¶Šé«˜å¤„ç†è¶Šå¿«ï¼Œä½†ä¼šæ¶ˆè€—æ›´å¤šç³»ç»Ÿèµ„æºå’ŒAPIé…é¢
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ç¬¬å››æ­¥ï¼šæ‰§è¡Œé‡å‘½å -->
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-play-circle me-2"></i>
                                    ç¬¬å››æ­¥ï¼šæ‰§è¡Œé‡å‘½å
                                </h6>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-success w-100 mb-2" id="startRenameBtn" disabled>
                                    <i class="bi bi-magic me-2"></i>å¼€å§‹æ™ºèƒ½é‡å‘½å
                                </button>
                                <button class="btn btn-outline-secondary w-100" id="clearBtn">
                                    <i class="bi bi-arrow-clockwise me-2"></i>é‡æ–°å¼€å§‹
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- å³ä¾§ï¼šæ–‡ä»¶å¤„ç†åŒºåŸŸ -->
                    <div class="col-8">
                        <div class="h-100 d-flex flex-column">
                            <!-- ç»Ÿä¸€çš„æ–‡ä»¶å¤„ç†åˆ—è¡¨ -->
                            <div class="card h-100 d-flex flex-column" id="fileProcessCard">
                                <div class="card-header d-flex justify-content-between align-items-center flex-shrink-0">
                                    <h6 class="mb-0">
                                        <i class="bi bi-list-check me-2 text-primary"></i>
                                        æ–‡ä»¶å¤„ç†åˆ—è¡¨
                                        <span class="badge bg-secondary ms-2" id="fileCount">0</span>
                                    </h6>
                                    <div class="d-flex align-items-center gap-2">
                                        <!-- æ–‡ä»¶ç±»å‹è¿‡æ»¤å™¨ -->
                                        <div class="btn-group btn-group-sm" role="group" id="fileTypeFilters">
                                            <button class="btn btn-outline-secondary active" data-type="all">
                                                <i class="bi bi-files"></i> å…¨éƒ¨ (0)
                                            </button>
                                        </div>

                                        <!-- æ“ä½œæŒ‰é’® -->
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-sm btn-success" id="applyAllBtn" disabled>
                                                <i class="bi bi-check-all me-1"></i>åº”ç”¨å…¨éƒ¨
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary" id="regenerateBtn" disabled>
                                                <i class="bi bi-arrow-clockwise me-1"></i>é‡æ–°ç”Ÿæˆ
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- è¿›åº¦æ¡ -->
                                <div id="progressContainer" class="px-3 pt-3 flex-shrink-0" style="display: none;">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <small class="text-muted" id="progressText">å‡†å¤‡å¤„ç†...</small>
                                        <small class="text-muted" id="progressPercent">0%</small>
                                    </div>
                                    <div class="progress mb-3" style="height: 6px;">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated"
                                             id="progressBar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                </div>

                                <!-- æ–‡ä»¶åˆ—è¡¨ - ä½¿ç”¨flex-grow-1å æ»¡å‰©ä½™ç©ºé—´ -->
                                <div class="flex-grow-1 d-flex flex-column position-relative" style="min-height: 0;">
                                    <div id="fileList" class="flex-grow-1 overflow-auto pe-2">
                                        <div class="text-center text-muted p-5" id="emptyState">
                                            <i class="bi bi-folder-plus display-4 mb-3"></i>
                                            <h5>é€‰æ‹©æ–‡ä»¶å¤¹å¼€å§‹å¤„ç†</h5>
                                            <p class="mb-0">ç‚¹å‡»å·¦ä¾§"é€‰æ‹©æ–‡ä»¶å¤¹"æŒ‰é’®ï¼Œç„¶åç‚¹å‡»"å¼€å§‹æ™ºèƒ½é‡å‘½å"</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- åº•éƒ¨ç»Ÿè®¡ä¿¡æ¯ - å›ºå®šåœ¨åº•éƒ¨ -->
                                <div class="card-footer bg-light flex-shrink-0" id="statsFooter" style="display: none;">
                                    <div class="row text-center">
                                        <div class="col-3">
                                            <div class="text-success fw-bold" id="successCount">0</div>
                                            <small class="text-muted">æˆåŠŸ</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="text-danger fw-bold" id="failureCount">0</div>
                                            <small class="text-muted">å¤±è´¥</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="text-warning fw-bold" id="pendingCount">0</div>
                                            <small class="text-muted">å¾…å¤„ç†</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="text-info fw-bold" id="totalCount">0</div>
                                            <small class="text-muted">æ€»è®¡</small>
                                        </div>
                                    </div>
                                </div>
                            </div>



                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<!-- æ¨¡å‹å¯¹æ¯”æ¨¡æ€æ¡† -->
<div class="modal fade" id="modelCompareModal" tabindex="-1" aria-labelledby="modelCompareModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modelCompareModalLabel">
                    <i class="bi bi-cpu me-2"></i>AIæ¨¡å‹å¯¹æ¯”ä¸å»ºè®®
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- æ¨èæ¨¡å‹ -->
                <div class="alert alert-success" role="alert">
                    <h6 class="alert-heading">
                        <i class="bi bi-star-fill me-2"></i>æ¨èæ¨¡å‹
                    </h6>
                    <div class="row">
                        <div class="col-md-6">
                            <strong>å¯¹è¯æ¨¡å‹ï¼š</strong>Qwen3-Next-80B-A3B-Instruct
                            <br><small class="text-muted">âš¡ æœ€å¿«å“åº” (2.7ç§’) | ğŸ¯ é«˜è´¨é‡è¾“å‡º | ğŸ’° ä¸­ç­‰æˆæœ¬</small>
                        </div>
                        <div class="col-md-6">
                            <strong>è§†è§‰æ¨¡å‹ï¼š</strong>è±†åŒ…1.6 Flash
                            <br><small class="text-muted">âš¡ æé€Ÿå“åº” (2.9ç§’) | ğŸ“· å›¾ç‰‡ç†è§£ | ğŸ’° ä½æˆæœ¬</small>
                        </div>
                    </div>
                </div>

                <!-- æ¨¡å‹å¯¹æ¯”è¡¨æ ¼ -->
                <div class="row">
                    <div class="col-12">
                        <h6><i class="bi bi-chat-dots me-2"></i>å¯¹è¯æ¨¡å‹å¯¹æ¯”</h6>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>æ¨¡å‹åç§°</th>
                                        <th>æœåŠ¡å•†</th>
                                        <th>å“åº”é€Ÿåº¦</th>
                                        <th>è¾“å‡ºè´¨é‡</th>
                                        <th>æˆæœ¬</th>
                                        <th>é€‚ç”¨åœºæ™¯</th>
                                        <th>çŠ¶æ€</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-success">
                                        <td><strong>â­ Qwen3-Next-80B-A3B</strong></td>
                                        <td>ç¡…åŸºæµåŠ¨</td>
                                        <td><span class="badge bg-success">æå¿« (2.7s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td>é€šç”¨ä»»åŠ¡ï¼Œå¿«é€Ÿå“åº”</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr class="table-info">
                                        <td><strong>â­ Qwen2.5-72B</strong></td>
                                        <td>ç¡…åŸºæµåŠ¨</td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰ (10s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td>å¹³è¡¡æ€§èƒ½ï¼Œæ¨èä½¿ç”¨</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr>
                                        <td>DeepSeek V3</td>
                                        <td>ç¡…åŸºæµåŠ¨</td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰ (7s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td>å¤æ‚æ¨ç†ä»»åŠ¡</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr>
                                        <td>DeepSeek R1</td>
                                        <td>ç¡…åŸºæµåŠ¨</td>
                                        <td><span class="badge bg-danger">æ…¢ (23s)</span></td>
                                        <td><span class="badge bg-primary">æé«˜</span></td>
                                        <td><span class="badge bg-danger">é«˜</span></td>
                                        <td>æ·±åº¦æ¨ç†åˆ†æ</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr>
                                        <td>è±†åŒ…1.6 Thinking</td>
                                        <td>è±†åŒ…</td>
                                        <td><span class="badge bg-danger">æ…¢ (18s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td>æ€ç»´åˆ†æä»»åŠ¡</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr>
                                        <td>DeepSeek Chat</td>
                                        <td>DeepSeekå®˜æ–¹</td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰ (13s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-success">ä½</span></td>
                                        <td>æ€§ä»·æ¯”é€‰æ‹©</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-12">
                        <h6><i class="bi bi-eye me-2"></i>è§†è§‰æ¨¡å‹å¯¹æ¯”</h6>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>æ¨¡å‹åç§°</th>
                                        <th>æœåŠ¡å•†</th>
                                        <th>å“åº”é€Ÿåº¦</th>
                                        <th>è¯†åˆ«è´¨é‡</th>
                                        <th>æˆæœ¬</th>
                                        <th>é€‚ç”¨åœºæ™¯</th>
                                        <th>çŠ¶æ€</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-success">
                                        <td><strong>â­ è±†åŒ…1.6 Flash</strong></td>
                                        <td>è±†åŒ…</td>
                                        <td><span class="badge bg-success">æå¿« (2.9s)</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td><span class="badge bg-success">ä½</span></td>
                                        <td>å¿«é€Ÿå›¾ç‰‡å¤„ç†</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                    <tr>
                                        <td>Qwen2.5-VL-32B</td>
                                        <td>ç¡…åŸºæµåŠ¨</td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰ (11s)</span></td>
                                        <td><span class="badge bg-success">é«˜</span></td>
                                        <td><span class="badge bg-warning">ä¸­ç­‰</span></td>
                                        <td>è¯¦ç»†å›¾ç‰‡åˆ†æ</td>
                                        <td><span class="badge bg-success">âœ… å¯ç”¨</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ä½¿ç”¨å»ºè®® -->
                <div class="alert alert-info mt-4" role="alert">
                    <h6 class="alert-heading">
                        <i class="bi bi-lightbulb me-2"></i>ä½¿ç”¨å»ºè®®
                    </h6>
                    <ul class="mb-0">
                        <li><strong>æ—¥å¸¸ä½¿ç”¨ï¼š</strong>æ¨è Qwen3-Next-80B-A3B-Instructï¼Œé€Ÿåº¦å¿«è´¨é‡é«˜</li>
                        <li><strong>å›¾ç‰‡å¤„ç†ï¼š</strong>æ¨è è±†åŒ…1.6 Flashï¼Œå“åº”æå¿«æˆæœ¬ä½</li>
                        <li><strong>å¤æ‚æ¨ç†ï¼š</strong>é€‰æ‹© DeepSeek R1ï¼Œè´¨é‡æœ€é«˜ä½†é€Ÿåº¦è¾ƒæ…¢</li>
                        <li><strong>æˆæœ¬ä¼˜å…ˆï¼š</strong>é€‰æ‹© DeepSeek Chat å®˜æ–¹ç‰ˆï¼Œæ€§ä»·æ¯”æœ€é«˜</li>
                        <li><strong>å¤šæœåŠ¡å•†æ¨¡å¼ï¼š</strong>å¯é…ç½®å¤šä¸ªæ¨¡å‹è‡ªåŠ¨åˆ‡æ¢ï¼Œæé«˜æˆåŠŸç‡</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                <button type="button" class="btn btn-primary" id="applyRecommendedModel">åº”ç”¨æ¨èé…ç½®</button>
            </div>
        </div>
    </div>
</div>

<!-- åŠ è½½æç¤º -->
<div class="position-fixed top-50 start-50 translate-middle" id="loadingSpinner" style="display: none; z-index: 9999;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">åŠ è½½ä¸­...</span>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- ä¾§è¾¹æ ç®¡ç† -->
<script src="/js/sidebar.js"></script>
<!-- ä¸»é¢˜ç®¡ç† -->
<script src="/js/theme.js"></script>
<!-- é€šç”¨å·¥å…· -->
<script src="/js/utils.js"></script>
<!-- Ai é‡å‘½åé¡µé¢è„šæœ¬ -->
<script src="/js/rename.js"></script>
</body>
</html>
